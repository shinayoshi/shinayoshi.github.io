
<!DOCTYPE html>
<html class="no-js" lang="ja">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <meta name="generator" content="Hugo 0.15" />

    <base href="http://www.shinayoshi.net/" />
    <title>shinayoshi&#39;s note</title>
    <link rel="canonical" href="http://www.shinayoshi.net/" />
    <link href="http://www.shinayoshi.net//img/favicon.ico" type="image/vnd.microsoft.icon" rel="icon" />
    <link href="http://www.shinayoshi.net/index.xml" rel="alternate" title="shinayoshi&#39;s note" type="application/rss+xml" />

    
    <link href="http://www.shinayoshi.net//css/bootstrap.min.css" rel="stylesheet">

    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://yandex.st/highlightjs/8.0/styles/default.min.css">

    
    
    
  </head>
  <body>
    <div id="wrap">


      <header role="banner">
        <nav class="navbar navbar-default" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" title="toggle navbar" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              <a class="navbar-brand" href="http://www.shinayoshi.net//">shinayoshi&#39;s note</a>
            </div>
            <div class="navbar-collapse collapse">
              <ul class="nav navbar-nav">
                <li><a href="http://www.shinayoshi.net//">Home</a></li>
                <li><a href="http://www.shinayoshi.net//post/">All posts</a></li>
              </ul>
              <ul class="nav navbar-nav navbar-right">
                
                <li>
                  <form class="search navbar-form navbar-right" role="search" action="https://www.google.com/search" method="GET">
                    <input type="hidden" name="sitesearch" value="www.shinayoshi.net" />
                    <div class="form-group">
                      <input type="text" class="form-control" placeholder="Search" name="q" />
                    </div>
                  </form>
                </li>
                
                <li>
                  <a class="subscribe-rss" href="http://www.shinayoshi.net/index.xml" title="subscribe via RSS">
                    <i class="fa fa-rss fa-lg"></i>
                  </a>
                </li>
              </ul>
            </div>
          </div>
        </nav>
      </header>


      <div id="main" role="main" class="container">
        <div id="content">
          <div class="row">
            <div class="page-content col-md-9">
              
              <article>
                <div class="title">
                  <h1><a href="http://www.shinayoshi.net/post/2016/08/11/install-zabbix-agent-on-raspbian/">Raspbian(Jessie)にZabbix Agentをインストール</a></h1>
                  <p>
                    <span class="label label-primary">Thu Aug 11, 2016</span> in
                    
                    
                    <a href="http://www.shinayoshi.net//categories/server">server</a>
                     using tags
                    
                    
                    <a href="http://www.shinayoshi.net//tags/raspberrypi">raspberrypi</a>
                    
                     , 
                    <a href="http://www.shinayoshi.net//tags/jessie">jessie</a>
                    
                     , 
                    <a href="http://www.shinayoshi.net//tags/zabbix">zabbix</a>
                    
                  </p>
                </div>
                <div class="contents">
                  

<p>Raspbian(Jessie)にZabbix Agentをインストールしてサーバ監視を行うまでのメモです。
Zabbix Serverのインストールは別のメモになります。</p>

<h2 id="パッケージの更新:235ab9bc7c5a5e6a7bcc83bc43bc05a7">パッケージの更新</h2>

<p>Raspbianのパッケージを最新する。</p>

<pre><code>$ sudo apt-get update
$ sudo apt-get upgrade
</code></pre>

<h2 id="zabbix-agentのインストール:235ab9bc7c5a5e6a7bcc83bc43bc05a7">Zabbix Agentのインストール</h2>

<p>Zabbix Agentのインストール</p>

<pre><code>$ sudo apt-get install zabbix-agent
</code></pre>

<h2 id="zabbix-agentの設定:235ab9bc7c5a5e6a7bcc83bc43bc05a7">Zabbix Agentの設定</h2>

<p>Zabbix Agentを設定する。</p>

<pre><code>$ sudo vi /etc/zabbix/zabbix_agentd.conf
Server=(Zabbix server IP address)
ServerActive=(Zabbix server IP address)
Hostname=(Hostname)

$ sudo systemctl restart zabbix-agent
</code></pre>

<h2 id="zabbix-serverでの監視登録:235ab9bc7c5a5e6a7bcc83bc43bc05a7">Zabbix Serverでの監視登録</h2>

<p>ブラウザからZabbix ServerのURL(<code>http://IPアドレス/zabbix</code>)にアクセスしてログインする。</p>

<p>「設定」⇒「ホスト」⇒「ホストの作成」を選択する。</p>

<p>ホスト名の設定やテンプレートの選択を行い、保存を選択する。</p>

<p>以上</p>

                </div>
              </article>
              
              <article>
                <div class="title">
                  <h1><a href="http://www.shinayoshi.net/post/2016/08/10/install-zabbix-server-on-raspbian/">Raspbian(Jessie)にZabbix Serverをインストール</a></h1>
                  <p>
                    <span class="label label-primary">Wed Aug 10, 2016</span> in
                    
                    
                    <a href="http://www.shinayoshi.net//categories/server">server</a>
                     using tags
                    
                    
                    <a href="http://www.shinayoshi.net//tags/raspberrypi">raspberrypi</a>
                    
                     , 
                    <a href="http://www.shinayoshi.net//tags/jessie">jessie</a>
                    
                     , 
                    <a href="http://www.shinayoshi.net//tags/zabbix">zabbix</a>
                    
                  </p>
                </div>
                <div class="contents">
                  

<p>Raspbian(Jessie)にZabbix Serverをインストールするメモです。
Zabbix Agentのインストールは別のメモになります。</p>

<ul>
<li><a href="https://www.zabbix.com/documentation/2.2/manual/installation/install_from_packages">3 Installation from packages [Zabbix Documentation 2.2]</a></li>
</ul>

<h2 id="パッケージの更新:4df21ad0746a34acfa37879eaf637713">パッケージの更新</h2>

<p>Raspbianのパッケージを最新する。</p>

<pre><code>$ sudo apt-get update
$ sudo apt-get upgrade
</code></pre>

<h2 id="zabbix-serverのインストール:4df21ad0746a34acfa37879eaf637713">Zabbix Serverのインストール</h2>

<p>Zabbix Serverのインストール</p>

<p>インストール途中でMySQLのrootアカウントのパスワードを求められるので、適宜設定する。</p>

<pre><code>$ sudo apt-get install zabbix-server-mysql zabbix-frontend-php
$ sudo apt-get install php5-mysql
$ sudo apt-get install task-japanese
</code></pre>

<h3 id="mysqlの初期設定:4df21ad0746a34acfa37879eaf637713">MySQLの初期設定</h3>

<p>MySQLのセキュア設定</p>

<pre><code>$ mysql_secure_installation
In order to log into MySQL to secure it, we'll need the current
password for the root user.  If you've just installed MySQL, and
you haven't set the root password yet, the password will be blank,
so you should just press enter here.

Enter current password for root (enter for none): 
OK, successfully used password, moving on...

Setting the root password ensures that nobody can log into the MySQL
root user without the proper authorisation.

You already have a root password set, so you can safely answer 'n'.

Change the root password? [Y/n] n
 ... skipping.

By default, a MySQL installation has an anonymous user, allowing anyone
to log into MySQL without having to have a user account created for
them.  This is intended only for testing, and to make the installation
go a bit smoother.  You should remove them before moving into a
production environment.

Remove anonymous users? [Y/n] Y
 ... Success!

Normally, root should only be allowed to connect from 'localhost'.  This
ensures that someone cannot guess at the root password from the network.

Disallow root login remotely? [Y/n] Y
 ... Success!

By default, MySQL comes with a database named 'test' that anyone can
access.  This is also intended only for testing, and should be removed
before moving into a production environment.

Remove test database and access to it? [Y/n] Y
 - Dropping test database...
ERROR 1008 (HY000) at line 1: Can't drop database 'test'; database doesn't exist
 ... Failed!  Not critical, keep moving...
 - Removing privileges on test database...
 ... Success!

Reloading the privilege tables will ensure that all changes made so far
will take effect immediately.

Reload privilege tables now? [Y/n] Y
 ... Success!

Cleaning up...



All done!  If you've completed all of the above steps, your MySQL
installation should now be secure.

Thanks for using MySQL!
</code></pre>

<p>MySQLの初期設定</p>

<pre><code>$ sudo vi /etc/mysql/my.cnf
[mysqld]
character-set-server=utf8
collation-server=utf8_general_ci
skip-character-set-client-handshake
default-storage-engine=InnoDB
innodb_file_per_table
innodb_buffer_pool_size=256M
skip-name-resolve

[mysqldump]
default-character-set=utf8

[mysql]
default-character-set=utf8
</code></pre>

<ul>
<li><a href="https://dev.mysql.com/doc/refman/5.5/en/server-system-variables.html">MySQL :: MySQL 5.5 Reference Manual :: 5.1.4 Server System Variables</a></li>
</ul>

<p>MySQLの再起動</p>

<pre><code>$ sudo systemctl restart mysql
</code></pre>

<h3 id="apache2の初期設定:4df21ad0746a34acfa37879eaf637713">Apache2の初期設定</h3>

<p>Apache2のセキュリティ設定</p>

<pre><code>$ sudo vi /etc/apache2/conf-available/security.conf
ServerTokens Prod
ServerSignature Off
</code></pre>

<p>Apache2の文字コード設定</p>

<pre><code>$ sudo vi /etc/apache2/conf-available/charset.conf
#AddDefaultCharset UTF-8
</code></pre>

<p>Apache2のServerName設定</p>

<pre><code>$ sudo sh -c &quot;echo ServerName ${HOSTNAME} &gt; /etc/apache2/conf-available/fqdn.conf&quot;
$ sudo a2enconf fqdn
</code></pre>

<p>Apache2の再起動</p>

<pre><code>$ sudo apachectl configtest
$ sudo systemctl restart apache2
</code></pre>

<ul>
<li><a href="http://mk-55.hatenablog.com/entry/2014/07/07/004510">ubuntuにおけるapache2のAH00558エラーを解決する。 - mk_55&rsquo;s diary</a></li>
</ul>

<h2 id="zabbix-serverの設定:4df21ad0746a34acfa37879eaf637713">Zabbix Serverの設定</h2>

<p>データベースの作成</p>

<pre><code>$ mysql -uroot -p
Enter password:
mysql&gt; 
mysql&gt; create database zabbix character set utf8 collate utf8_bin;
mysql&gt; grant all privileges on zabbix.* to zabbix@localhost identified by 'zabbix_password';
mysql&gt; quit

$ zcat /usr/share/zabbix-server-mysql/schema.sql.gz | mysql -uzabbix -p zabbix
$ zcat /usr/share/zabbix-server-mysql/images.sql.gz | mysql -uzabbix -p zabbix
$ zcat /usr/share/zabbix-server-mysql/data.sql.gz | mysql -uzabbix -p zabbix
</code></pre>

<p>Apache2のZabbixサイト設定</p>

<pre><code>$ sudo cp /usr/share/doc/zabbix-frontend-php/examples/apache.conf /etc/apache2/conf-available/zabbix.conf
$ sudo vi /etc/apache2/conf-available/zabbix.conf
# Add the following lines
php_value max_execution_time 300
php_value memory_limit 128M
php_value post_max_size 16M
php_value upload_max_filesize 2M
php_value max_input_time 300
php_value date.timezone Asia/Tokyo

$ sudo a2enconf zabbix
$ sudo apachectl configtest
$ sudo systemctl restart apache2
</code></pre>

<p>Zabbixのサーバ設定</p>

<pre><code>$ sudo vi /etc/zabbix/zabbix_server.conf
DBHost=localhost
DBName=zabbix
DBUser=zabbix
DBPassword=zabbix_password

$ sudo vi /etc/default/zabbix-server
START=yes

$ sudo ln -s /usr/share/fonts/truetype/unifont/unifont.ttf /usr/share/zabbix/fonts/
$ sudo vi /usr/share/zabbix/include/defines.inc.php
define('ZBX_GRAPH_FONT_NAME',		'unifont');

$ sudo systemctl restart zabbix-server
</code></pre>

<h2 id="zabbix-serverへのアクセス:4df21ad0746a34acfa37879eaf637713">Zabbix Serverへのアクセス</h2>

<p>ブラウザからZabbix ServerのURL(<code>http://IPアドレス/zabbix</code>)にアクセスする。</p>

<p>Zabbixの初期設定画面が表示されるので、画面の指示に従いながら設定を行う。</p>

<h2 id="zabbix-serverへのログイン:4df21ad0746a34acfa37879eaf637713">Zabbix Serverへのログイン</h2>

<p>Zabbixの初期設定が完了するとログイン画面が表示されるので、デフォルトアカウント(<code>Admin/zabbix</code>)でログインする。
ログイン後は画面右上のProfileを開き、パスワードを変更しておく。</p>

<p>以上</p>

                </div>
              </article>
              
              <article>
                <div class="title">
                  <h1><a href="http://www.shinayoshi.net/post/2016/08/07/backup-raspbian/">Raspbianをバックアップ・リストアする</a></h1>
                  <p>
                    <span class="label label-primary">Sun Aug 7, 2016</span> in
                    
                    
                    <a href="http://www.shinayoshi.net//categories/server">server</a>
                     using tags
                    
                    
                    <a href="http://www.shinayoshi.net//tags/raspberrypi">raspberrypi</a>
                    
                     , 
                    <a href="http://www.shinayoshi.net//tags/backup">backup</a>
                    
                  </p>
                </div>
                <div class="contents">
                  

<p>RaspbianをSDカード丸ごとバックアップ・リストアするメモです。
今回はddコマンドを使ってディスクイメージを書き出す方法でバックアップ・リストアを行います。</p>

<h2 id="バックアップ:6cd0cb3f4c453418b61672dbcf967693">バックアップ</h2>

<p>SDカードデバイスを確認する。</p>

<pre><code>$ diskutil list
/dev/disk1
   #:                       TYPE NAME                    SIZE       IDENTIFIER
   0:     FDisk_partition_scheme                        *32.2 GB    disk1
   1:             Windows_FAT_32 boot                    66.1 MB    disk1s1
   2:                      Linux                         32.2 GB    disk1s2
</code></pre>

<p>SDカードデバイスをアンマウントする。</p>

<pre><code>$ diskutil unmountDisk /dev/disk1
Unmount of all volumes on disk1 was successful
</code></pre>

<p>SDカードのディスクイメージをバックアップする。</p>

<pre><code>$ sudo dd bs=1m if=/dev/rdisk1 of=~/Desktop/raspi_backup.img
Password:
30735+0 records in
30735+0 records out
32227983360 bytes transferred in 1610.088954 secs (20016275 bytes/sec)
</code></pre>

<p>SDカードデバイスを取り出す。</p>

<pre><code>$ diskutil eject /dev/disk1
Disk /dev/disk1 ejected
</code></pre>

<h2 id="リストア:6cd0cb3f4c453418b61672dbcf967693">リストア</h2>

<p>SDカードデバイスを確認する。</p>

<pre><code>$ diskutil list
/dev/disk1
   #:                       TYPE NAME                    SIZE       IDENTIFIER
   0:     FDisk_partition_scheme                        *32.2 GB    disk1
   1:             Windows_FAT_32 boot                    66.1 MB    disk1s1
   2:                      Linux                         32.2 GB    disk1s2
</code></pre>

<p>SDカードデバイスをアンマウントする。</p>

<pre><code>$ diskutil unmountDisk /dev/disk1
Unmount of all volumes on disk1 was successful
</code></pre>

<p>ディスクイメージをSDカードにリストアする。</p>

<pre><code>$ sudo dd bs=1m if=~/Desktop/raspi_backup.img of=/dev/rdisk1
Password:
30735+0 records in
30735+0 records out
32227983360 bytes transferred in 2153.545392 secs (14965082 bytes/sec)
</code></pre>

<p>SDカードデバイスを取り出す。</p>

<pre><code>$ diskutil eject /dev/disk1
Disk /dev/disk1 ejected
</code></pre>

<p>以上</p>

                </div>
              </article>
              
              <article>
                <div class="title">
                  <h1><a href="http://www.shinayoshi.net/post/2016/07/16/raspberrypi-kivy-setup/">RaspbianにKivyをセットアップ</a></h1>
                  <p>
                    <span class="label label-primary">Sat Jul 16, 2016</span> in
                    
                    
                    <a href="http://www.shinayoshi.net//categories/server">server</a>
                     using tags
                    
                    
                    <a href="http://www.shinayoshi.net//tags/raspberrypi">raspberrypi</a>
                    
                     , 
                    <a href="http://www.shinayoshi.net//tags/kivy">kivy</a>
                    
                  </p>
                </div>
                <div class="contents">
                  

<p>Raspberry Pi 7&rdquo; Touch Screen LCDに接続したRaspberry Pi 3 (Raspbian)にKivyをインストールしてデモを動かすまでのメモです。</p>

<h2 id="kivyのインストール:7e54fa4db923fa1d790b8a2df258af41">Kivyのインストール</h2>

<p>Kivyに必要なパッケージをインストールする。</p>

<pre><code>$ sudo apt-get update
$ sudo apt-get install libsdl2-dev libsdl2-image-dev libsdl2-mixer-dev libsdl2-ttf-dev pkg-config libgl1-mesa-dev libgles2-mesa-dev python-setuptools libgstreamer1.0-dev git-core gstreamer1.0-plugins-{bad,base,good,ugly} gstreamer1.0-{omx,alsa} python-dev cython

$ sudo reboot
</code></pre>

<p>Kivyをインストールする。</p>

<pre><code>$ git clone https://github.com/kivy/kivy
$ cd kivy
$ make
$ echo &quot;export PYTHONPATH=$(pwd):\$PYTHONPATH&quot; &gt;&gt; ~/.profile
$ source ~/.profile
</code></pre>

<ul>
<li><a href="https://kivy.org/docs/installation/installation-rpi.html">Installation on Raspberry Pi — Kivy 1.9.2-dev0 documentation</a></li>
</ul>

<h2 id="raspberry-pi-7-touch-screen-lcdの利用設定:7e54fa4db923fa1d790b8a2df258af41">Raspberry Pi 7&rdquo; Touch Screen LCDの利用設定</h2>

<pre><code>$ vi ~/.kivy/config.ini
[input]
mouse = mouse
mtdev\_%(name)s = probesysfs,provider=mtdev
hid\_%(name)s = probesysfs,provider=hidinput
</code></pre>

<h2 id="kivyデモを実行:7e54fa4db923fa1d790b8a2df258af41">Kivyデモを実行</h2>

<p>デモ実行に必要なパッケージをインストールする。</p>

<pre><code>$ sudo apt-get install xclip xsel
$ sudo pip install pygments docutils
</code></pre>

<h3 id="デモ１-showcase:7e54fa4db923fa1d790b8a2df258af41">デモ１(showcase)</h3>

<pre><code>$ cd ~/kivy/examples/demo/showcase
$ python main.py
</code></pre>

<h3 id="デモ２-3drendering:7e54fa4db923fa1d790b8a2df258af41">デモ２(3Drendering)</h3>

<pre><code>$ cd ~/kivy/examples/3Drendering
$ python main.py
</code></pre>

<h2 id="kivyのプログラムを作成-実行:7e54fa4db923fa1d790b8a2df258af41">Kivyのプログラムを作成・実行</h2>

<p><a href="http://a-zumi.net/python-kivy-simple-paint/">【Python】Kivyを使ってシンプルなペイントツールを作成する方法</a>を参考に、自前でペイントツールを作成し、実行する。</p>

<p>ソースコードを作成する。</p>

<pre><code>$ vi paint.py
</code></pre>

<script src="https://gist.github.com/kurozumi/31f250c38662a102afa5.js"></script>

<p>実行する。</p>

<pre><code>$ python paint.py  
</code></pre>

<p>Raspberry Pi 7&rdquo; Touch Screen LCDをタッチすることで線が引けることを確認する。</p>

<p>以上</p>

                </div>
              </article>
              
              <article>
                <div class="title">
                  <h1><a href="http://www.shinayoshi.net/post/2016/07/12/raspberrypi-touchscreen-setup/">Raspberry Pi 3にRaspberry Pi 7&#34; Touch Screen LCDを接続</a></h1>
                  <p>
                    <span class="label label-primary">Tue Jul 12, 2016</span> in
                    
                    
                    <a href="http://www.shinayoshi.net//categories/server">server</a>
                     using tags
                    
                    
                    <a href="http://www.shinayoshi.net//tags/raspberrypi">raspberrypi</a>
                    
                     , 
                    <a href="http://www.shinayoshi.net//tags/jessie">jessie</a>
                    
                  </p>
                </div>
                <div class="contents">
                  

<p>Raspberry Pi 3のディスプレイとして「Official 7&rdquo; Touchscreen Display＋フレーム セット（青）」を購入した。
Raspberry Pi 3に接続して最低限使えるようにするまでをメモする。</p>

<h2 id="接続:2020837d634538f02be0a31ea2dca63e">接続</h2>

<p>以下のWebサイトを参考に接続する。</p>

<ul>
<li><a href="https://raspberry-pi.ksyic.com/page/page/pgp.id/4">Raspberry Pi 7インチ タッチ・スクリーン ディスプレイ 接続・取り付け方法 - Raspberry Pi Shop by KSY:</a></li>
<li><a href="https://www.raspberrypi.org/blog/the-eagerly-awaited-raspberry-pi-display/">The Eagerly Awaited Raspberry Pi Display - Raspberry Pi</a></li>
</ul>

<h2 id="天地逆転を直す:2020837d634538f02be0a31ea2dca63e">天地逆転を直す</h2>

<p>購入したフレームを使用すると天地が逆転した状態で起動する(製品仕様)。Raspberry Pi 3側で画面の回転を設定することで天地逆転を直す。</p>

<pre><code>$ sudo vi /boot/config.txt
#Add the following line
lcd_rotate=2
$ sudo reboot
</code></pre>

<ul>
<li><a href="http://learn.pimoroni.com/tutorial/pi-lcd/getting-started-with-raspberry-pi-7-touchscreen-lcd">Getting Started with the Raspberry Pi 7&rdquo; Touchscreen LCD - Pimoroni Yarr-niversity</a></li>
</ul>

<h2 id="日本語環境の整備:2020837d634538f02be0a31ea2dca63e">日本語環境の整備</h2>

<p>日本語関連パッケージをインストールする。余計なパッケージもインストールされてしまいますが、楽な方法ではあります。</p>

<pre><code>$ sudo apt-get install task-japanese task-japanese-desktop
</code></pre>

<h2 id="スクリーンキーボードのインストール:2020837d634538f02be0a31ea2dca63e">スクリーンキーボードのインストール</h2>

<p>Touchscreen Displayだけで操作を行うために、On Screen Keyboardを導入する。</p>

<pre><code>$ sudo apt-get install florence
$ sudo apt-get install at-spi2-core
</code></pre>

<p>ログイン画面でもOn Screen Keyboardを使用できるように設定する。</p>

<pre><code>$ sudo vi /etc/lightdm/lightdm-gtk-greeter.conf
show-indicators=~language;~a11y;~session;~power
keyboard=florence --focus
</code></pre>

<ul>
<li><a href="http://xmodulo.com/onscreen-virtual-keyboard-linux.html">How to use on-screen virtual keyboard on Linux - Xmodulo</a></li>
<li><a href="https://www.raspberrypi.org/forums/viewtopic.php?f=108&amp;t=123189">Raspberry Pi • View topic - Solution for Jessie and Florence virtual keyboard crash</a></li>
<li><a href="https://www.raspberrypi.org/forums/viewtopic.php?f=63&amp;t=113526">Raspberry Pi • View topic - Virtual Keyboard on Login Screen</a></li>
</ul>

<h2 id="リモートデスクトップ接続:2020837d634538f02be0a31ea2dca63e">リモートデスクトップ接続</h2>

<p>xrdp接続でRaspberry Pi 3にリモートデスクトップ接続する。</p>

<pre><code>$ sudo apt-get install xrdp
</code></pre>

<p>Firewall等でリモートデスクトップ接続に必要なポートを開ける。ポートの確認は以下のファイルを確認する。</p>

<pre><code>$ cat /etc/xrdp/xrdp.ini
$ cat /etc/xrdp/sesman.ini
</code></pre>

<ul>
<li><a href="http://www.tapun.net/raspi/raspberry-pi-xrdp">Raspberry Pi | RDPで接続してみたいxrdpでWindows端末に画面転送します – たぷん日記</a></li>
</ul>

<p>以上</p>

                </div>
              </article>
              
              <article>
                <div class="title">
                  <h1><a href="http://www.shinayoshi.net/post/2016/07/10/raspbian-wifi-setup/">Raspberry Pi 3でWiFi設定</a></h1>
                  <p>
                    <span class="label label-primary">Sun Jul 10, 2016</span> in
                    
                    
                    <a href="http://www.shinayoshi.net//categories/server">server</a>
                     using tags
                    
                    
                    <a href="http://www.shinayoshi.net//tags/raspberrypi">raspberrypi</a>
                    
                     , 
                    <a href="http://www.shinayoshi.net//tags/wifi">WiFi</a>
                    
                  </p>
                </div>
                <div class="contents">
                  

<p>Raspberry Pi 3には標準でWiFiモジュールが搭載されている。
今回はWiFi設定を行う。</p>

<h2 id="wifiネットワークのスキャン:366b0c30f1d198568510d56bfae90a97">WiFiネットワークのスキャン</h2>

<p>接続するWiFiネットワークを確認する。</p>

<pre><code>$ sudo iwlist wlan0 scan
</code></pre>

<h2 id="アクセスポイントの設定:366b0c30f1d198568510d56bfae90a97">アクセスポイントの設定</h2>

<p>アクセスポイントを設定する。</p>

<pre><code>$ sudo cp -p /etc/wpa_supplicant/wpa_supplicant.conf{,.org}
$ sudo sh -c &quot;wpa_passphrase 'アクセスポイント名(ESSID)' 'アクセスポイントのパスワード' &gt;&gt; /etc/wpa_supplicant/wpa_supplicant.conf&quot;
$ sudo cat /etc/wpa_supplicant/wpa_supplicant.conf
country=JP
ctrl_interface=DIR=/var/run/wpa_supplicant GROUP=netdev
update_config=1
network={
    ssid=&quot;アクセスポイント名(ESSID)&quot;
    #psk=&quot;先ほどのコマンドで入力したパスワード(不要であれば削除する)&quot;
    psk=暗号化されたパスワード
}
</code></pre>

<h2 id="wifiの有効化:366b0c30f1d198568510d56bfae90a97">WiFiの有効化</h2>

<p>WiFiを有効化する。</p>

<pre><code>$ sudo ifdown wlan0
$ sudo ifup wlan0
$ ifconfig wlan0
</code></pre>

<h2 id="ipアドレスの固定化:366b0c30f1d198568510d56bfae90a97">IPアドレスの固定化</h2>

<p>IPアドレスを固定化する。</p>

<pre><code>$ sudo vi /etc/dhcpcd.conf
#Add the following line
interface wlan0
static ip_address=192.168.100.10⁄24
static routers=192.168.100.1
static domain_name_servers=192.168.100.1
#static domain_name=
#static domain_search=
</code></pre>

<p>WiFiデバイスを再起動する。IPアドレスが固定化されていることを確認する。</p>

<pre><code>$ sudo ifdown wlan0
$ sudo ifup wlan0
$ ifconfig wlan0
</code></pre>

<h2 id="参考:366b0c30f1d198568510d56bfae90a97">参考</h2>

<ul>
<li><a href="https://www.raspberrypi.org/documentation/configuration/wireless/wireless-cli.md">Setting WiFi up via the command line - Raspberry Pi Documentation</a></li>
<li><a href="http://move0tofu.hatenablog.jp/entry/2016/04/30/215517">Raspberry Pi 3 Model B環境構築 その3(WiFi設定) - @0tofuの備忘録&hellip;</a></li>
</ul>

<p>以上</p>

                </div>
              </article>
              
              <article>
                <div class="title">
                  <h1><a href="http://www.shinayoshi.net/post/2016/07/09/raspbian-jessie-setup/">Raspbianの初期設定</a></h1>
                  <p>
                    <span class="label label-primary">Sat Jul 9, 2016</span> in
                    
                    
                    <a href="http://www.shinayoshi.net//categories/server">server</a>
                     using tags
                    
                    
                    <a href="http://www.shinayoshi.net//tags/raspberrypi">raspberrypi</a>
                    
                     , 
                    <a href="http://www.shinayoshi.net//tags/jessie">jessie</a>
                    
                  </p>
                </div>
                <div class="contents">
                  

<p>こちらも何番煎じかわかりませんが、Raspbianをインストールした後の初期設定メモです。</p>

<h2 id="前提:29d369a29c800517b14390fe39a79e9d">前提</h2>

<p>Raspberry Pi 3にRaspbian Jessie (2016-05-27版)をインストールした環境の初期設定を想定する。ただし、セキュリティ関連の設定は省略する(例えば、SSH接続の公開鍵認証設定やFirewall設定、不要サービスの停止など)。</p>

<h2 id="パッケージ更新:29d369a29c800517b14390fe39a79e9d">パッケージ更新</h2>

<pre><code>$ sudo apt-get update
$ sudo apt-get upgrade
</code></pre>

<ul>
<li><a href="https://www.raspberrypi.org/documentation/raspbian/updating.md">Updating and Upgrading Raspbian - Raspberry Pi Documentation</a></li>
</ul>

<h2 id="ipアドレス固定化:29d369a29c800517b14390fe39a79e9d">IPアドレス固定化</h2>

<p>Raspberry Pi 3のIPアドレスを固定する。</p>

<pre><code>$ sudo vi /etc/dhcpcd.conf
#Add the following line
interface eth0
static ip_address=192.168.40.10/24
static routers=192.168.40.254
static domain_name_servers=192.168.100.1
#static domain_name=
#static domain_search=
</code></pre>

<ul>
<li>&ldquo;man dhcpcd.conf&rdquo;</li>
</ul>

<h2 id="usbポートの電流供給増加:29d369a29c800517b14390fe39a79e9d">USBポートの電流供給増加</h2>

<p>USBポートの電流供給を1.2A(4ポート合計)まで供給できるようにする。</p>

<pre><code>$ sudo vi /boot/config.txt
#Add the following line
max_usb_current=1
</code></pre>

<ul>
<li><a href="http://elinux.org/RPiconfig">RPiconfig - eLinux.org</a></li>
</ul>

<h2 id="ntp設定:29d369a29c800517b14390fe39a79e9d">NTP設定</h2>

<p>NTP同期先を設定する。</p>

<pre><code>$ sudo vi /etc/ntp.conf
#Add the line
server ntp.nict.jp iburst
server ntp.jst.mfeed.ad.jp iburst
# comment out
#server 0.debian.pool.ntp.org iburst
#server 1.debian.pool.ntp.org iburst
#server 2.debian.pool.ntp.org iburst
#server 3.debian.pool.ntp.org iburst
</code></pre>

<p>NTPサーバを再起動する。</p>

<pre><code>$ sudo systemctl restart ntp
</code></pre>

<p>時刻同期の状態を確認する。</p>

<pre><code>$ ntpq -p
</code></pre>

<ul>
<li><a href="http://vogel.at.webry.info/201501/article_5.html">NTPサーバの設定 パソコン鳥のブログ/ウェブリブログ</a></li>
</ul>

<h2 id="chkconfigのインストール:29d369a29c800517b14390fe39a79e9d">chkconfigのインストール</h2>

<p>Raspbian起動時のサービスを管理するためにchkconfigをインストールする。</p>

<pre><code>$ sudo apt-get install chkconfig
</code></pre>

<h2 id="raspi-config関連:29d369a29c800517b14390fe39a79e9d">raspi-config関連</h2>

<pre><code>$ sudo raspi-config
</code></pre>

<h3 id="ディスク拡張:29d369a29c800517b14390fe39a79e9d">ディスク拡張</h3>

<ol>
<li>「1 Expand Filesystem」を選択する。</li>
<li>「Ok」を選択する。</li>
<li>raspi-configの初期画面に戻る。</li>
</ol>

<h3 id="文字コード設定:29d369a29c800517b14390fe39a79e9d">文字コード設定</h3>

<ol>
<li>「5 Internationalisation Options」を選択する。</li>
<li>「I1 Change Locale」を選択する。</li>
<li>「en_GB.UTF-8 UTF-8」の選択を外す。</li>
<li>「ja_JP.UTF-8 UTF-8」を選択する。</li>
<li>「Ok」を選択する。</li>
<li>「ja_JP.UTF-8」を選択する。</li>
<li>「Ok」を選択する。</li>
<li>raspi-configの初期画面に戻る。</li>
</ol>

<h3 id="タイムゾーン設定:29d369a29c800517b14390fe39a79e9d">タイムゾーン設定</h3>

<ol>
<li>「5 Internationalisation Options」を選択する。</li>
<li>「I2 Change Timezone」を選択する。</li>
<li>「Asia」を選択する。</li>
<li>「Tokyo」を選択する。</li>
<li>raspi-configの初期画面に戻る。</li>
</ol>

<h3 id="wifiの国設定:29d369a29c800517b14390fe39a79e9d">Wifiの国設定</h3>

<ol>
<li>「5 Internationalisation Options」を選択する。</li>
<li>「I4 Change Wi-fi Country」を選択する。</li>
<li>「JP Japan」を選択する。</li>
<li>「Ok」を選択する。</li>
<li>raspi-configの初期画面に戻る。</li>
</ol>

<h3 id="ホスト名変更:29d369a29c800517b14390fe39a79e9d">ホスト名変更</h3>

<ol>
<li>「9 Advanced Options」を選択する。</li>
<li>「A2 Hostname」を選択する。</li>
<li>「Ok」を選択する。</li>
<li>ホスト名を設定する。</li>
<li>「Ok」を選択する。</li>
<li>raspi-configの初期画面に戻る。</li>
</ol>

<h3 id="raspi-config終了:29d369a29c800517b14390fe39a79e9d">raspi-config終了</h3>

<ol>
<li>「Finish」を選択する。</li>
<li>リブートの確認が求められるため、「Yes」を選択する。</li>
</ol>

<p>以上</p>

                </div>
              </article>
              
              <article>
                <div class="title">
                  <h1><a href="http://www.shinayoshi.net/post/2016/07/09/raspbian-jessie-install/">Raspbianのインストール</a></h1>
                  <p>
                    <span class="label label-primary">Sat Jul 9, 2016</span> in
                    
                    
                    <a href="http://www.shinayoshi.net//categories/server">server</a>
                     using tags
                    
                    
                    <a href="http://www.shinayoshi.net//tags/raspberrypi">raspberrypi</a>
                    
                     , 
                    <a href="http://www.shinayoshi.net//tags/jessie">jessie</a>
                    
                  </p>
                </div>
                <div class="contents">
                  

<p>何番煎じかわかりませんが、ディスプレイ、キーボード、マウスを使用せずにRaspbianのインストールを行い、リモートPCからSSH接続が行えるようにするまでのメモです。</p>

<h2 id="使用したもの:b6f02b3d9579b63dd4fc7d440d3b8ed6">使用したもの</h2>

<ul>
<li>Raspberry Pi 3 Model B</li>
<li>micro SDカード(32GB)</li>
<li>USB ACアダプタ(Raspberry Pi 3の電源用)</li>
<li>USBケーブル(Raspberry Pi 3の電源用)</li>
<li>LANケーブル(Raspberry Pi 3の有線LAN接続用)</li>
<li>Mac(作業用)</li>
</ul>

<h2 id="raspbianダウンロード:b6f02b3d9579b63dd4fc7d440d3b8ed6">Raspbianダウンロード</h2>

<p>公式サイトからRaspbianをダウンロードする。
2016年7月9日時点の最新バージョンは「2016-05-27-raspbian-jessie.zip」でした。</p>

<ul>
<li><a href="https://www.raspberrypi.org/downloads/raspbian/">Download Raspbian for Raspberry Pi</a></li>
</ul>

<h2 id="raspbian書き込み:b6f02b3d9579b63dd4fc7d440d3b8ed6">Raspbian書き込み</h2>

<p>SDカードにRaspbianのイメージを書き込む。</p>

<p>SDカードデバイスを確認する。</p>

<pre><code>$ diskutil list
/dev/disk1
   #:                       TYPE NAME                    SIZE       IDENTIFIER
   0:     FDisk_partition_scheme                        *32.2 GB    disk1
   1:             Windows_FAT_32 NO NAME                 32.2 GB    disk1s1
</code></pre>

<p>SDカードデバイスをアンマウントする。</p>

<pre><code>$ diskutil unmountDisk /dev/disk1
Unmount of all volumes on disk1 was successful
</code></pre>

<p>SDカードにRaspbianのイメージを書き込む。</p>

<pre><code>$ sudo dd bs=1m if=2016-05-27-raspbian-jessie.img of=/dev/rdisk1
Password:
958+1 records in
958+1 records out
4019191808 bytes transferred in 269.163670 secs (14932148 bytes/sec)
</code></pre>

<p>SDカードデバイスを取り出す。</p>

<pre><code>$ diskutil eject /dev/disk1
Disk /dev/disk1 ejected
</code></pre>

<h2 id="raspbian起動:b6f02b3d9579b63dd4fc7d440d3b8ed6">Raspbian起動</h2>

<p>Raspbianのイメージを書き込んだSDカードをRaspberry Pi 3にセットして電源を入れる。
Raspberry Pi 3には有線LANも接続しておく。</p>

<h2 id="raspbian接続:b6f02b3d9579b63dd4fc7d440d3b8ed6">Raspbian接続</h2>

<p>Raspberry Pi 3のIPアドレスを確認する。</p>

<pre><code>$ arp -a
? (192.168.1.10) at b8:27:eb:xx:xx:xx on en0 ifscope [ethernet]
</code></pre>

<p>SSHでRaspberry Pi 3に接続する。</p>

<pre><code>$ ssh pi@192.168.1.10
pi@192.168.1.10's password:
※piユーザのデフォルトパスワードは「raspberry」
</code></pre>

<h2 id="参考:b6f02b3d9579b63dd4fc7d440d3b8ed6">参考</h2>

<ul>
<li><a href="https://www.raspberrypi.org/documentation/installation/installing-images/mac.md">Installing operating system images on Mac OS - Raspberry Pi Documentation</a></li>
</ul>

<p>以上</p>

                </div>
              </article>
              
              <article>
                <div class="title">
                  <h1><a href="http://www.shinayoshi.net/post/2016/05/15/apache-setup/">ApacheでWebサイトを公開する</a></h1>
                  <p>
                    <span class="label label-primary">Sun May 15, 2016</span> in
                    
                    
                    <a href="http://www.shinayoshi.net//categories/server">server</a>
                     using tags
                    
                    
                    <a href="http://www.shinayoshi.net//tags/centos">centos</a>
                    
                  </p>
                </div>
                <div class="contents">
                  

<p>ApacheでWebサイトを公開するまでの手順のメモです。</p>

<h2 id="apacheとphpのインストール:cb5d764d8c08bb095f7a6ed7bff2ff04">ApacheとPHPのインストール</h2>

<p>Webサーバ(Apache)とPHPをインストールします。</p>

<pre><code># yum install httpd php php-mbstring
</code></pre>

<h2 id="apacheの設定:cb5d764d8c08bb095f7a6ed7bff2ff04">Apacheの設定</h2>

<p>Apacheを設定します。</p>

<pre><code># vi /etc/httpd/conf/httpd.conf
#ServerName www.example.com:80
↓変更
ServerName www.example.com:80

#
# AllowOverride controls what directives may be placed in .htaccess files.
# It can be &quot;All&quot;, &quot;None&quot;, or any combination of the keywords:
#   Options FileInfo AuthConfig Limit
#
    AllowOverride None
    ↓変更
    AllowOverride All

AddDefaultCharset UTF-8
↓変更
#AddDefaultCharset UTF-8
</code></pre>

<h2 id="apacheの起動:cb5d764d8c08bb095f7a6ed7bff2ff04">Apacheの起動</h2>

<p>Apacheを起動します。</p>

<pre><code>$ sudo systemctl start httpd
$ sudo systemctl enable httpd
</code></pre>

<h2 id="firewallの設定:cb5d764d8c08bb095f7a6ed7bff2ff04">Firewallの設定</h2>

<p>FirewallでWeb通信を許可します。</p>

<pre><code>$ sudo firewall-cmd \-\-permanent \-\-zone=public \-\-add-service=http
$ sudo firewall-cmd \-\-reload
$ sudo firewall-cmd \-\-list-all-zones
</code></pre>

<h2 id="動作確認:cb5d764d8c08bb095f7a6ed7bff2ff04">動作確認</h2>

<p>外部からWebサイトにアクセスできるか確認します。</p>

<pre><code>$ sudo vi /var/www/html/index.php
&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;ja&quot;&gt;
  &lt;head&gt;
    &lt;meta charset=&quot;utf-8&quot; /&gt;
    &lt;title&gt;net-tools&lt;/title&gt;
    &lt;meta name=&quot;description&quot; content=&quot;shinayoshi shinayoshi.net&quot; /&gt;
    &lt;meta name=&quot;author&quot; content=&quot;shinayoshi&quot; /&gt;
  &lt;/head&gt;
  &lt;body&gt;
    &lt;p&gt;&lt;?php echo $_SERVER[&quot;REMOTE_ADDR&quot;]; ?&gt;&lt;/p&gt;
  &lt;/body&gt;
&lt;/html&gt;
</code></pre>

<p>Webブラウザ等でWebサーバにアクセスできることを確認します。
正常にアクセスできていれば接続元のIPアドレスが表示されているはずです。</p>

<h2 id="その他:cb5d764d8c08bb095f7a6ed7bff2ff04">その他</h2>

<p>実際にWebサイトを公開するには、DNSの設定や素敵なコンテンツを作成する必要がありますが割愛します。</p>

                </div>
              </article>
              
              <article>
                <div class="title">
                  <h1><a href="http://www.shinayoshi.net/post/2016/01/16/onamae-vpn-setup/">お名前.com VPS(KVM)の初期設定(CentOS 7 1511)</a></h1>
                  <p>
                    <span class="label label-primary">Sat Jan 16, 2016</span> in
                    
                    
                    <a href="http://www.shinayoshi.net//categories/server">server</a>
                     using tags
                    
                    
                    <a href="http://www.shinayoshi.net//tags/centos">centos</a>
                    
                  </p>
                </div>
                <div class="contents">
                  

<p>お名前.comのVPS(KVM)の初期設定メモを残しておく。
「CentOS-7-x86_64-Minimal-1511.iso」を使用して再インストール後からの設定を記載しています。</p>

<h2 id="rootでログイン:130a6ce433fd353093f8e4a56dec5622">rootでログイン</h2>

<p>お名前.comのコンソール画面でログインを行います。</p>

<pre><code>login: root
Password:
</code></pre>

<p>ログインに成功すると以下のようなプロンプトが表示されます。</p>

<pre><code>[root@&lt;ホスト名&gt; ~\]#
</code></pre>

<p>以降の手順では、rootアカウントのプロンプトを<code>#</code>で表現します。</p>

<h2 id="シリアルコンソール接続の有効化:130a6ce433fd353093f8e4a56dec5622">シリアルコンソール接続の有効化</h2>

<p>シリアルコンソールで接続できるように設定します。</p>

<pre><code># vi /etc/default/grub
GRUB_CMDLINE_LINUX=&quot;rd.lvm.lv=centos/root rd.lvm.lv=centos/swap rhgb quiet&quot;
↓変更
GRUB_CMDLINE_LINUX=&quot;rd.lvm.lv=centos/root rd.lvm.lv=centos/swap rhgb quiet console=tty0 console=ttyS0,115200n8r&quot;
# grub2-mkconfig \-o /boot/grub2/grub.cfg
# reboot
</code></pre>

<h2 id="共用sshサーバ経由のシリアルコンソール接続:130a6ce433fd353093f8e4a56dec5622">共用SSHサーバ経由のシリアルコンソール接続</h2>

<p>お名前.comのVPS(KVM)には、VPSにシリアルコンソール接続するための共用SSHサーバが用意されています。以降の設定はこのSSHサーバ経由のシリアルコンソール接続で作業します。</p>

<p>SSH接続経由のシリアルコンソールの接続方法については、お名前.comのサイトに詳しく書かれているのでそちらをご確認ください。<a href="http://guide.onamae-server.com/vpskvm/3_14_15_75_2/">SSH接続経由のシリアルコンソール | SSH接続 | VPS (KVM) 活用ガイド</a></p>

<h2 id="ホスト名変更:130a6ce433fd353093f8e4a56dec5622">ホスト名変更</h2>

<p>ホスト名の変更を行います。</p>

<pre><code># hostnamectl set-hostname newhost.example.com
</code></pre>

<p>ホスト名の変更を反映するために再起動を行います。</p>

<pre><code># reboot
</code></pre>

<p>再度、お名前.comのコンソール画面でログインを行い、ホスト名が変更されていることを確認します。</p>

<h2 id="パッケージの更新:130a6ce433fd353093f8e4a56dec5622">パッケージの更新</h2>

<p>パッケージを最新の状態に更新します。</p>

<pre><code># yum \-y update
</code></pre>

<p>kernelのバージョンアップがあった場合にはサーバの再起動を実施します。</p>

<pre><code># reboot
</code></pre>

<h2 id="管理者アカウントの作成:130a6ce433fd353093f8e4a56dec5622">管理者アカウントの作成</h2>

<p>通常使用する管理者アカウントを作成します。また、管理者アカウントにパスワードを設定します。</p>

<pre><code># useradd centos
# passwd centos
Changing password for user centos.
New password: &lt;パスワード入力&gt;
Retype new password: &lt;パスワード再入力&gt;
passwd: all authentication tokens updated successfully.
# gpasswd \-a centos wheel
</code></pre>

<h2 id="sudo権限の付与:130a6ce433fd353093f8e4a56dec5622">sudo権限の付与</h2>

<p>管理者アカウントにsudo権限を付与します。以下ではcentosにROOT関連のコマンドとSHUTDOWN関連のコマンド以外のすべてのコマンドの実行権限を付与しています。</p>

<pre><code># visudo \-f /etc/sudoers.d/wheel
Cmnd_Alias ROOT = /bin/su, /usr/bin/sudo
Cmnd_Alias SHUTDOWN = /sbin/halt, /sbin/shutdown, /sbin/poweroff, /sbin/reboot, /sbin/fastboot, /sbin/init
%wheel  ALL=(ALL)       ALL,!ROOT,!SHUTDOWN
</code></pre>

<h2 id="rootのログアウトと管理者アカウントでログイン:130a6ce433fd353093f8e4a56dec5622">rootのログアウトと管理者アカウントでログイン</h2>

<p>管理者アカウントを作成してsudoが使えるようになったので、rootアカウントをログアウトして管理者アカウントでログインし直します。</p>

<pre><code># exit
logout
＜省略＞
login: centos
Password:
[centos@&lt;ホスト名&gt; ~]$
</code></pre>

<p>以降の手順では、管理者アカウントのプロンプトを<code>$</code>で表現します。</p>

<h2 id="rootアカウントの無効化:130a6ce433fd353093f8e4a56dec5622">rootアカウントの無効化</h2>

<p>すべての作業は管理者アカウントで行うため、rootアカウントを無効化します。※シリアルコンソールからもrootでログインできなくなりますので、設定する際は慎重に行ってください。</p>

<pre><code>$ sudo passwd -l root
[sudo] password for centos:
Locking password for user root.
passwd: Success
</code></pre>

<h2 id="root宛てメールの転送:130a6ce433fd353093f8e4a56dec5622">root宛てメールの転送</h2>

<p>root宛てに届くメールを管理者アカウントに転送するように設定します。</p>

<pre><code>$ sudo vi /etc/aliases
root:           centos
$ sudo newaliases
</code></pre>

<h2 id="firewalldの設定:130a6ce433fd353093f8e4a56dec5622">Firewalldの設定</h2>

<p>Firewalldを使用して不要な通信を拒否するように設定します。</p>

<h3 id="firewalldのインストール:130a6ce433fd353093f8e4a56dec5622">Firewalldのインストール</h3>

<pre><code>$ sudo yum \-y install firewalld
$ sudo systemctl start firewalld
$ sudo systemctl enable firewalld
</code></pre>

<h3 id="firewalldの設定確認:130a6ce433fd353093f8e4a56dec5622">Firewalldの設定確認</h3>

<pre><code>$ sudo firewall-cmd --get-active-zones
$ sudo firewall-cmd --list-all-zones
$ sudo firewall-cmd --get-services
</code></pre>

<h3 id="firewalldの初期設定:130a6ce433fd353093f8e4a56dec5622">Firewalldの初期設定</h3>

<p>eth0のゾーンをpublicに変更します。</p>

<pre><code>$ sudo firewall-cmd --zone=public --change-interface=eth0
</code></pre>

<p>publicゾーンで不要なサービスを無効化します。</p>

<pre><code>$ sudo firewall-cmd --permanent --zone=public --remove-service=ssh
$ sudo firewall-cmd --permanent --zone=public --remove-service=dhcpv6-client
$ sudo firewall-cmd --reload
</code></pre>

<p>設定の確認</p>

<pre><code>$ sudo firewall-cmd --zone=public --list-all
</code></pre>

<h2 id="selinuxの無効化:130a6ce433fd353093f8e4a56dec5622">SELinuxの無効化</h2>

<pre><code>$ sudo setenforce Permissive
$ sudo getenforce
</code></pre>

<pre><code>$ sudo vi /etc/selinux/config
SELINUX=enforcing
↓変更
SELINUX=permissive
</code></pre>

<h2 id="ipv6の無効化:130a6ce433fd353093f8e4a56dec5622">IPv6の無効化</h2>

<p>IPv6を無効化します。</p>

<pre><code>$ sudo sysctl -w net.ipv6.conf.all.disable_ipv6=1
$ sudo sysctl -w net.ipv6.conf.default.disable_ipv6=1
$ sudo sysctl -a | grep disable_ipv6
</code></pre>

<p>上記のコマンドではシステムを再起動した場合にIPv6が有効になってしまうため、再起動しても無効になるように設定します。</p>

<pre><code>$ sudo vi /etc/sysctl.d/10-disableipv6.conf
net.ipv6.conf.all.disable_ipv6=1
net.ipv6.conf.default.disable_ipv6=1
</code></pre>

<h3 id="postfixのipv6無効化:130a6ce433fd353093f8e4a56dec5622">PostfixのIPv6無効化</h3>

<p>IPv6の無効化に併せてPostfixもIPv6を無効化します。</p>

<pre><code>$ sudo vi /etc/postfix/main.cf
#inet_protocols = all
inet_protocols = ipv4
$ sudo systemctl restart postfix
</code></pre>

<h2 id="ntpの時刻同期:130a6ce433fd353093f8e4a56dec5622">NTPの時刻同期</h2>

<p>chronyにより時刻同期を行うように設定します。</p>

<pre><code>$ sudo yum -y install chrony
$ sudo vi /etc/chrony.conf
#server 0.centos.pool.ntp.org iburst
#server 1.centos.pool.ntp.org iburst
#server 2.centos.pool.ntp.org iburst
#server 3.centos.pool.ntp.org iburst
server ntp.nict.jp iburst
server ntp.jst.mfeed.ad.jp iburst
</code></pre>

<p>chronydを起動します。</p>

<pre><code>$ sudo systemctl start chronyd
$ sudo systemctl enable chronyd
</code></pre>

<p>時刻の同期状況を確認するには以下のコマンドを実行します。</p>

<pre><code>$ chronyc sources
</code></pre>

<h2 id="不要サービスの停止:130a6ce433fd353093f8e4a56dec5622">不要サービスの停止</h2>

<p>セキュリティのため、サーバのリソースのために不要サービスを停止します。お名前.comのVPS(KVM)には共用SSH経由のシリアルコンソールでログインするため、SSHを停止しています。</p>

<pre><code>$ sudo systemctl list-units --type=service
$ sudo systemctl stop sshd
$ sudo systemctl disable sshd
</code></pre>

<h2 id="logwatchのインストール:130a6ce433fd353093f8e4a56dec5622">logwatchのインストール</h2>

<p>logwatchをインストールします。</p>

<pre><code>$ sudo yum -y install logwatch
</code></pre>

<p>logwatchの実行結果を確認します。</p>

<pre><code>$ sudo logwatch --output stdout
</code></pre>

<p>以上、初期設定は終了となります。</p>

                </div>
              </article>
              
              <div class="pagination">
                <ul class="pager">
  
  <li class="previous"><a href="/">&larr; Newer</a></li>
  
  <li>Page 2 of 3</li>
  
  <li class="next"><a href="/page/3/">Older &rarr;</a></li>
  
</ul>

              </div>
            </div>
            <div class="sidebar col-md-3">
              <aside>
  
<section class="panel panel-default">
  <div class="panel-heading">
    <h1 class="panel-title">Profile</h1>
  </div>
  <div id="profile" class="panel-body text-center">
    <img src="http://www.shinayoshi.net//img/logo.png" alt="logo" class="img-responsive center-block" />
    <p>
      <a href="http://www.shinayoshi.net//about/">Author: shinayoshi</a>
    </p>
    <ul class="list-inline">
  

  

  

  
  <li>
    <a href="https://github.com/shinayoshi" target="_blank">
      <i class="fa fa-github-square fa-lg"></i>
    </a>
  </li>
  

  
  <li>
    <a href="https://bitbucket.org/shinayoshi" target="_blank">
      <i class="fa fa-bitbucket-square fa-lg"></i>
    </a>
  </li>
  

  
  <li>
    <a href="http://www.slideshare.net/shinayoshi" target="_blank">
      <i class="fa fa-slideshare fa-lg"></i>
    </a>
  </li>
  
</ul>

  </div>
</section>

  <section class="panel panel-default">
  <div class="panel-heading">
    <h1 class="panel-title">Recent Posts</h1>
  </div>
  <div id="recent_posts" class="list-group">
    
      
      <a href="http://www.shinayoshi.net/post/2016/08/26/setting-file-server/" class="list-group-item">Raspbian(Jessie)をファイルサーバにする [ 2016-08-26 ]</a>
      
      <a href="http://www.shinayoshi.net/post/2016/08/24/cache-dns-on-raspbian/" class="list-group-item">Raspbian(Jessie)でキャッシュDNSを構築する [ 2016-08-24 ]</a>
      
      <a href="http://www.shinayoshi.net/post/2016/08/22/installing-squid-on-raspbian/" class="list-group-item">Raspbian(Jessie)にSquidをインストールする [ 2016-08-22 ]</a>
      
      <a href="http://www.shinayoshi.net/post/2016/08/21/to-register-the-device-in-cacti/" class="list-group-item">Cactiにデバイスを登録する [ 2016-08-21 ]</a>
      
      <a href="http://www.shinayoshi.net/post/2016/08/20/installing-cacti-on-raspberrypi/" class="list-group-item">Raspbian(Jessie)にCactiをインストールする [ 2016-08-20 ]</a>
      
      <a href="http://www.shinayoshi.net/post/2016/08/16/security-setting-on-cowrie/" class="list-group-item">Cowrieのセキュリティ設定 [ 2016-08-16 ]</a>
      
      <a href="http://www.shinayoshi.net/post/2016/08/16/install-kippo-graph/" class="list-group-item">Kippo-GraphをインストールしてCowrieのログを可視化する [ 2016-08-16 ]</a>
      
      <a href="http://www.shinayoshi.net/post/2016/08/15/install-cowrie-on-raspbian/" class="list-group-item">Raspbian(Jessie)にCowrieをインストールする [ 2016-08-15 ]</a>
      
      <a href="http://www.shinayoshi.net/post/2016/08/13/add-fortigate-mib-on-raspbian/" class="list-group-item">Raspbian(Jessie)にFortiGateのプライベートMIBを追加する [ 2016-08-13 ]</a>
      
      <a href="http://www.shinayoshi.net/post/2016/08/11/monitoring-snmp-devices-on-zabbix/" class="list-group-item">ZabbixでSNMPデバイスの監視を行う [ 2016-08-11 ]</a>
      
    
  </div>
</section>

  
<section class="panel panel-default">
  <div class="panel-heading">
    <h1 class="panel-title">Categories</h1>
  </div>
  <div id="categories" class="list-group">
    
    <a href="http://www.shinayoshi.net//categories/diary" class="list-group-item"><span class="badge">2</span>diary</a>
    
    <a href="http://www.shinayoshi.net//categories/server" class="list-group-item"><span class="badge">20</span>server</a>
    
  </div>
</section>

  
<section class="panel panel-default">
  <div class="panel-heading">
    <h1 class="panel-title">Tags</h1>
  </div>
  <div id="tags" class="panel-body">
    
    
    <a href="http://www.shinayoshi.net//tags/backup" >backup (1)</a>
    
    
    
    <a href="http://www.shinayoshi.net//tags/bind" >bind (1)</a>
    
    
    
    <a href="http://www.shinayoshi.net//tags/blog" >blog (1)</a>
    
    
    
    <a href="http://www.shinayoshi.net//tags/cacti" >cacti (2)</a>
    
    
    
    <a href="http://www.shinayoshi.net//tags/centos" >centos (2)</a>
    
    
    
    <a href="http://www.shinayoshi.net//tags/cowrie" >cowrie (3)</a>
    
    
    
    <a href="http://www.shinayoshi.net//tags/fgt-60d" >fgt-60d (1)</a>
    
    
    
    <a href="http://www.shinayoshi.net//tags/igo" >igo (1)</a>
    
    
    
    <a href="http://www.shinayoshi.net//tags/jessie" >jessie (15)</a>
    
    
    
    <a href="http://www.shinayoshi.net//tags/kippo-graph" >kippo-graph (1)</a>
    
    
    
    <a href="http://www.shinayoshi.net//tags/kivy" >kivy (1)</a>
    
    
    
    <a href="http://www.shinayoshi.net//tags/raid" >raid (1)</a>
    
    
    
    <a href="http://www.shinayoshi.net//tags/raspberrypi" >raspberrypi (16)</a>
    
    
    
    <a href="http://www.shinayoshi.net//tags/shogi" >shogi (1)</a>
    
    
    
    <a href="http://www.shinayoshi.net//tags/squid" >squid (1)</a>
    
    
    
    <a href="http://www.shinayoshi.net//tags/wifi" >wifi (1)</a>
    
    
    
    <a href="http://www.shinayoshi.net//tags/zabbix" >zabbix (3)</a>
    
    
  </div>
</section>

</aside>

            </div>
          </div>
        </div>
      </div>

      <div class="container">
        <div class="row">
          <div class="col-md-12">
            <hr />
          </div>
        </div>
      </div>
      <footer role="contentinfo">
        <div class="container">
          <p class="text-muted credits">
            Copyright (c) 2016 shinayoshi<br />
            <small>
              <span class="credit">Powered By <a href="http://hugo.spf13.com">Hugo</a></span>
            </small>
          </p>
        </div>
      </footer>

      
      <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
      
      <script src="http://www.shinayoshi.net//js/bootstrap.min.js"></script>

      <script src="https://yandex.st/highlightjs/8.0/highlight.min.js"></script>
      <script>hljs.initHighlightingOnLoad();</script>
      
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-37226857-2', 'auto');
  ga('send', 'pageview');
</script>


    </div>
  </body>
</html>

